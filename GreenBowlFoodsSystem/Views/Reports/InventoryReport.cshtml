@model IEnumerable<GreenBowlFoodsSystem.Models.FinishedProduct>

@{
    ViewData["Title"] = "Inventory Valuation Report";
}

<div class="d-flex justify-content-between align-items-center mb-4 d-print-none">
    <h2 class="text-white">📊 Inventory Valuation Report</h2>
     <div class="d-flex gap-2">
        <a asp-action="Index" class="btn btn-outline-light rounded-pill px-4">
            <i class="bi bi-arrow-left me-2"></i> Back to Reports
        </a>
        
        <button onclick="window.print()" class="btn btn-primary rounded-pill px-4">
            <i class="bi bi-printer-fill me-2"></i> Print Financials
        </button>
    </div>
</div>

<div class="d-none d-print-block text-center mb-4">
    <h1>Green Bowl Foods</h1>
    <h3>Current Stock Valuation Report</h3>
    <p>Generated on: @DateTime.Now.ToString("dd/MM/yyyy HH:mm")</p>
    <hr />
</div>

<div class="card shadow border-0">
    <div class="card-body">
        <table class="table table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Product Name</th>
                    <th>SKU</th>
                    <th class="text-center">Qty In Stock</th>
                    <th class="text-end">Unit Price</th>
                    <th class="text-end">Total Value</th>
                </tr>
            </thead>
            <tbody>
                @{ decimal grandTotal = 0; }
                @foreach (var item in Model)
                {
                    decimal rowTotal = item.QuantityAvailable * item.UnitPrice;
                    grandTotal += rowTotal;

                    <tr>
                        <td class="fw-bold">@item.ProductName</td>
                        <td><span class="badge bg-secondary">@item.SKU</span></td>
                        
                        <td class="text-center @(item.QuantityAvailable < 50 ? "text-danger fw-bold" : "")">
                            @item.QuantityAvailable
                        </td>
                        
                        <td class="text-end">@item.UnitPrice.ToString("C")</td>
                        <td class="text-end fw-bold text-success">£@rowTotal</td>
                    </tr>
                }
            </tbody>
            <tfoot class="table-light">
                <tr>
                    <td colspan="4" class="text-end text-muted fw-bold fs-5">TOTAL INVENTORY VALUE:</td>
                    <td class="text-end fw-bold fs-5 text-warning">£@grandTotal</td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>

<style>
    /* Estilos Específicos para Impresión */
    @@media print {
        body { background-color: white !important; color: black !important; }
        .card { box-shadow: none !important; border: 1px solid #ddd !important; }
        .badge { border: 1px solid #000; color: black !important; background: none !important; }
        .text-white { color: black !important; }
        .table-dark { background-color: #ddd !important; color: black !important; }
        /* Ocultar elementos innecesarios */
        header, footer, .btn, .navbar { display: none !important; }
    }
</style>